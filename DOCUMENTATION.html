<h1>DORA Lib4ri Assistant</h1>

<p>The <strong>DORA Lib4ri Assistant</strong> is a browser extension designed to streamline the workflow for editing metadata in the DORA repository (Lib4ri). It provides automated metadata fetching, intelligent form validation, and a powerful keyword manager.</p>

<hr />

<h2>Installation</h2>

<ol>
    <li><strong>Download</strong>: Get the latest <code>.xpi</code> file (for Firefox) or the unpacked extension folder (for Chrome/Edge).</li>
    <li><strong>Firefox</strong>:
        <ul>
            <li>Drag and drop the <code>.xpi</code> file into any open browser window.</li>
            <li>Alternatively, go to <code>about:addons</code>, click the gear icon, and select <strong>"Install Add-on From File..."</strong>.</li>
        </ul>
    </li>
    <li><strong>Chrome/Edge</strong>:
        <ul>
            <li>Go to <code>chrome://extensions</code>.</li>
            <li>Enable <strong>"Developer mode"</strong> (toggle in the top right).</li>
            <li>Click <strong>"Load unpacked"</strong> and select the extension folder.</li>
        </ul>
    </li>
</ol>

<hr />

<h2>Core Features</h2>

<h3>1. Metadata Auto-Fetch</h3>
<p>When you open an edit page in DORA, the assistant automatically scans for a DOI.</p>

<ul>
    <li><strong>Auto-Check</strong>: If a DOI is found, the assistant fetches metadata from <strong>Crossref</strong> and <strong>Unpaywall</strong>.</li>
    <li><strong>Result Box</strong>: A floating panel appears on the right side displaying:
        <ul>
            <li><strong>Open Access Status</strong> (Gold, Green, Hybrid, Closed).</li>
            <li><strong>License Information</strong> (e.g., CC-BY).</li>
            <li><strong>Version</strong> (Published Version vs. Accepted Manuscript).</li>
        </ul>
    </li>
    <li><strong>Quick Actions</strong>:
        <ul>
            <li><code>#hybrid setzen</code>: Adds the <code>#hybrid</code> tag to the "Additional Information" field.</li>
            <li><code>PDF ansehen</code>: Opens the full-text PDF (if available).</li>
            <li><code>Policy prüfen</code>: Checks the journal policy via Jisc Open Policy Finder.</li>
            <li><code>⚡</code>: Analyzes the PDF directly from the URL (extracts pages & keywords).</li>
        </ul>
    </li>
    <li><strong>Smart Features</strong>:
        <ul>
            <li><strong>Publisher Scan</strong>: Scans the publisher's website in the background to find direct PDF links (using Zotero-compatible metadata).</li>
            <li><strong>Affiliation Check</strong>: Verifies via <strong>Scopus API</strong> if the corresponding author is affiliated with PSI, Eawag, Empa, or WSL (requires API Key in Options).</li>
            <li><strong>Book Chapters</strong>: Special import button for book metadata (Editors, Book Title, ISBN).</li>
        </ul>
    </li>
</ul>

<blockquote>
    <p><strong>[Screenshot: Place a screenshot here showing the floating result box with OA status and buttons]</strong></p>
</blockquote>

<hr />

<h3>2. PDF Analysis</h3>
<p>Extract metadata (<strong>Page Count</strong> and <strong>Keywords</strong>) directly from PDF files without manual entry.</p>

<ul>
    <li><strong>Drag & Drop</strong>: Drop a PDF file into the designated zone at the bottom of the result box.</li>
    <li><strong>URL Analysis</strong>: Click the lightning bolt (⚡) icon next to a PDF link to analyze it directly via the backend.</li>
    <li><strong>Passive Monitor</strong>: The assistant automatically detects PDFs opened in other tabs or downloaded. The drop zone turns green ("⚡ PDF Detected") - click it to import.</li>
</ul>

<hr />

<h3>3. Keyword Manager</h3>
<p>The standard keyword input in DORA can be difficult to manage. The Assistant injects a <strong>"Keyword Manager"</strong> directly above the keyword field.</p>

<ul>
    <li><strong>Edit & Sort</strong>: Click the button to load existing keywords into a clean list.</li>
    <li><strong>Drag & Drop</strong>: Reorder keywords by dragging the handle (☰).</li>
    <li><strong>Auto-Formatting</strong>: Keywords are automatically corrected (e.g., "dna" &rarr; "DNA", "ph" &rarr; "pH") based on your settings.</li>
    <li><strong>Sync</strong>: Any changes are immediately synced back to the DORA form.</li>
</ul>

<blockquote>
    <p><strong>[Screenshot: Place a screenshot here showing the Keyword Manager with the sortable list]</strong></p>
</blockquote>

<hr />

<h3>4. Real-time Validation</h3>
<p>The assistant validates form fields as you type, highlighting errors with a <strong>red border</strong> and providing tooltips.</p>

<p><strong>Validation Rules:</strong></p>
<ul>
    <li><strong>Volume</strong>: Must be filled if "Publication Status" is "Published".</li>
    <li><strong>Start Page</strong>: Must include the page count (e.g., <code>(12 pp.)</code>) if the "End Page" is empty.</li>
    <li><strong>Sentence Case</strong>: Detects Title Case usage (capitalized words) in:
        <ul>
            <li>Article Title</li>
            <li>Conference Name</li>
            <li>Proceedings Title</li>
            <li>Series Title</li>
        </ul>
    </li>
    <li><strong>Author/Affiliation</strong>:
        <ul>
            <li>Flags "Standardized Form of Name" if it contains "nomatch" or "4RI".</li>
            <li>Requires an Affiliation/Department if an Author Name is entered.</li>
            <li><strong>Legacy Data</strong>: For publications before 2006, checks for "0000 PSI" in the Group field instead of requiring Lab/Division.</li>
            <li><strong>Grace Period</strong>: Author validation is skipped for publications older than 2006 or newer than 3 years.</li>
        </ul>
    </li>
</ul>

<blockquote>
    <p><strong>[Screenshot: Place a screenshot here showing a form field with a red error border]</strong></p>
</blockquote>

<hr />

<h3>5. Error Summary Panel</h3>
<p>If validation errors are found, a summary panel appears at the <strong>bottom right</strong> of the screen.</p>

<ul>
    <li><strong>Overview</strong>: Displays the total count of issues.</li>
    <li><strong>Details</strong>: Lists the specific errors to fix.</li>
    <li><strong>Navigation</strong>: Helps you find missing fields quickly.</li>
</ul>

<blockquote>
    <p><strong>[Screenshot: Place a screenshot here showing the Error Summary panel at the bottom right]</strong></p>
</blockquote>

<hr />

<h3>6. Configuration</h3>
<p>You can configure the extension via the <strong>Options</strong> page (Right-click extension icon -> Options).</p>

<ul>
    <li><strong>Scopus API Key</strong>: Enter your personal API Key to enable the Affiliation Check.</li>
    <li><strong>Keyword Exceptions</strong>: Manage custom replacement rules for keyword normalization.</li>
    <li><strong>PSI Data</strong>: Upload a new <code>psi_data.js</code> file to update employee/unit data dynamically.</li>
</ul>

<blockquote>
    <p><strong>[Screenshot: Place a screenshot here of the Options page]</strong></p>
</blockquote>
